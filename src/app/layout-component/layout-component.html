<div class="pokemon-league">
  <div class="p-4 sm:p-6 flex flex-col items-center text-center gap-3 sm:gap-5 bg-white rounded-lg">
    <button matButton="tonal">
        Tournament Statistics
      </button>
    <p class="text-2xl sm:text-4xl font-bold">Pok√©mon League</p>
    <p class="text-sm sm:text-xl max-w-xl px-4 sm:px-0">Explore performance statistics from the latest Pok√©mon . Sort by metrics to see who's leading the competition!</p>
  </div>
    
    <div class="my-4 sm:my-8 p-4 sm:p-6 flex flex-col sm:flex-row justify-center gap-4 sm:gap-8 bg-white rounded-lg">
        <div class="sortBy">
            <h4 class="mb-2 sm:mb-4 text-center sm:text-left"> Sort By:</h4>
      <mat-form-field class="w-full sm:w-auto">
        <mat-select [value]="sortBy" (selectionChange)="onSortByChange($event.value)">
          <mat-option value="wins">Wins</mat-option>
          <mat-option value="losses">Losses</mat-option>
          <mat-option value="ties">Ties</mat-option>
          <mat-option value="name">Name</mat-option>
          <mat-option value="baseExperience">Id</mat-option>
        </mat-select>
      </mat-form-field>
        </div>

        <div class="direction w-full sm:w-auto">
            <h4 class="mb-2 sm:mb-4 text-center sm:text-left"> Sort Direction:</h4>
      <mat-form-field class="w-full sm:w-auto">
        <mat-select [value]="sortDirection" (selectionChange)="onSortDirectionChange($event.value)">
          <mat-option value="desc">Descending</mat-option>
          <mat-option value="asc">Ascending</mat-option>
        </mat-select>
      </mat-form-field>
        </div>
        
    </div>


  @if (sortedResults.length === 0) {
    <div class="loading text-center mb-6 text-2xl">
      <p>Pokemon cards will be arriving soon</p>
    </div>
  }

  @if (sortedResults.length > 0) {
    <div class="pokemon-grid">
      @for (pokemon of sortedResults; track pokemon.id;) {
        <div class="pokemon-card bg-white p-4">
          <div class="card-header flex justify-between items-start">
            <div class="flex flex-col">
              <div class="flex items-center gap-2 mb-2">
                <div class="pokemon-type p-2 rounded font-bold" [attr.data-type]="pokemon.type">
                  {{ pokemon.type.toUpperCase() }}
                </div>
                <div class="text-xl">
                  üèÜ
                </div>
              </div>
              <p class="pokemon-name font-bold font-mono text-xl">{{ pokemon.name | titlecase }}</p>
              <h4> ADO </h4>
            </div>
            <div class="pokemon-sprite">
              <img [src]="pokemon.imageUrl" class="w-16 h-16 object-contain">
            </div>
          </div>

          <div class="stats-section flex flex-row justify-between px-4 mt-4 gap-2">
            <div class="win flex flex-col text-center bg-gray-100 rounded-lg p-3 flex-1">
                <div class="text-sm font-medium">Win</div>
                <div class="text-lg font-bold text-green-600">{{ pokemon.wins }}</div>
            </div>

            <div class="losses flex flex-col text-center bg-gray-100 rounded-lg p-3 flex-1">
                <div class="text-sm font-medium">Losses</div>
                <div class="text-lg font-bold text-red-600">{{ pokemon.losses }}</div>
            </div>

            <div class="ties flex flex-col text-center bg-gray-100 rounded-lg p-3 flex-1">
                <div class="text-sm font-medium">Ties</div>
                <div class="text-lg font-bold text-blue-600">{{ pokemon.ties }}</div>
            </div>
          </div>

          <!-- Win Rate Progress Bar -->
          <div class="progress-section px-4 mt-4">
            <div class="flex justify-between items-center mb-2">
              <span>Win Tie</span>
              <span class="font-bold">{{ pokemon.winRate.toFixed(1) }}%</span>
            </div>
            <div class="bg-gray-200 rounded-full h-3">
              <div class="bg-green-500 h-3 rounded-full" 
                   [style.width.%]="getStatPercentage(pokemon.winRate, 100)">
              </div>
            </div>
          </div>
          
          
        </div>
      }
    </div>
  }
</div>
